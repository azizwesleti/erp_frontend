<h2 mat-dialog-title>Add New Article</h2>

<mat-dialog-content>
  <form [formGroup]="articleForm" (ngSubmit)="onSubmit()">
    <div class="form-grid">
      <mat-form-field appearance="outline">
        <mat-label>Code</mat-label>
        <input matInput formControlName="code" required>
        <mat-error *ngIf="articleForm.get('code')?.hasError('required')">
          Code is required
        </mat-error>
        <mat-error *ngIf="articleForm.get('code')?.hasError('pattern')">
          Only alphanumeric characters allowed
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Designation</mat-label>
        <input matInput formControlName="designation" required>
        <mat-error *ngIf="articleForm.get('designation')?.hasError('required')">
          Designation is required
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Famille</mat-label>
        <mat-select formControlName="famille">
          <mat-option value="">-- Select Category --</mat-option>
          <mat-option *ngFor="let category of categories" [value]="category">
            {{ category }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Purchase Price</mat-label>
        <input matInput type="number" formControlName="prixAchat" required>
        <span matPrefix>$&nbsp;</span>
        <mat-error *ngIf="articleForm.get('prixAchat')?.hasError('required')">
          Purchase price is required
        </mat-error>
        <mat-error *ngIf="articleForm.get('prixAchat')?.hasError('min')">
          Must be positive
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Selling Price</mat-label>
        <input matInput type="number" formControlName="prixVente" required>
        <span matPrefix>$&nbsp;</span>
        <mat-error *ngIf="articleForm.get('prixVente')?.hasError('required')">
          Selling price is required
        </mat-error>
        <mat-error *ngIf="articleForm.get('prixVente')?.hasError('min')">
          Must be positive
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Stock</mat-label>
        <input matInput type="number" formControlName="stock" required>
        <mat-error *ngIf="articleForm.get('stock')?.hasError('required')">
          Stock is required
        </mat-error>
        <mat-error *ngIf="articleForm.get('stock')?.hasError('min')">
          Must be positive
        </mat-error>
      </mat-form-field>
    </div>
  </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="onCancel()">Cancel</button>
  <button mat-raised-button color="primary" 
          [disabled]="!articleForm.valid || isSubmitting"
          (click)="onSubmit()">
    <span *ngIf="!isSubmitting">Create</span>
    <span *ngIf="isSubmitting">Creating...</span>
  </button>
</mat-dialog-actions>